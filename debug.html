<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>INTERCEPTOR_V6.5_STABLE</title>
    <style>
        :root { --n: #00ff41; --b: #050505; --r: #ff0055; }
        body { background: var(--b); color: var(--n); font-family: monospace; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { border: 1px solid var(--n); padding: 12px; background: rgba(0,255,65,0.1); text-align: left; }
        td { border: 1px solid #222; padding: 12px; word-break: break-all; }
        .key-box { color: var(--r); border: 1px solid var(--r); padding: 2px 5px; font-weight: bold; }
        .res { color: #fff; font-size: 1.1em; font-weight: bold; }
    </style>
</head>
<body>
    <header style="display:flex; justify-content:space-between; border-bottom:2px solid var(--n); padding-bottom:10px;">
        <strong>[ PACKET_ANALYZER_ONLINE ]</strong>
        <button onclick="wipe()" style="background:var(--r); border:none; padding:10px; cursor:pointer; font-weight:bold;">WIPE_SERVER_STORAGE</button>
    </header>
    <table>
        <thead>
            <tr>
                <th style="width:120px;">SOURCE</th>
                <th style="width:150px;">SECRET_KEY</th>
                <th>DECRYPTED_CONTENT</th>
            </tr>
        </thead>
        <tbody id="logs"></tbody>
    </table>
<script>
    const API = '/api';
    function crypt(t, k) {
        if (!k) return t;
        let out = "";
        for (let i = 0; i < t.length; i++) {
            out += String.fromCharCode(t.charCodeAt(i) ^ k.charCodeAt(i % k.length));
        }
        return out;
    }
    async function wipe() { if(confirm("DELETE LOGS?")) { await fetch(API, {method:'DELETE'}); update(); } }
    async function update() {
        try {
            const r = await fetch(API);
            const data = await r.text();
            const lines = data.split('\n').filter(l => l.trim()).reverse();
            const tbody = document.getElementById('logs');
            tbody.innerHTML = "";
            lines.forEach(line => {
                let [u, full] = [line.split(": ")[0], line.split(": ").slice(1).join(": ")];
                let [cipher, key] = full.split("::KEY::");
                let decoded = "";
                try {
                    let raw = atob(cipher);
                    decoded = decodeURIComponent(key ? crypt(raw, key) : raw);
                } catch(e) { decoded = "[DECODE_ERROR]"; }
                
                tbody.innerHTML += `<tr>
                    <td>${u}</td>
                    <td>${key ? '<span class="key-box">'+key+'</span>' : 'OPEN'}</td>
                    <td class="res">${decoded}</td>
                </tr>`;
            });
        } catch(e) {}
    }
    setInterval(update, 3000); update();
</script>
</body>
</html>
